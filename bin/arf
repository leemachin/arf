#!/usr/bin/env ruby

lib = File.expand_path(File.dirname(__FILE__) + '/../lib')
$LOAD_PATH.unshift(lib) if File.directory?(lib) && !$LOAD_PATH.include?(lib)

require 'optparse'
require 'arf'

unless Process.euid.zero?
  puts "Sorry, the LED Board requires root privileges to run. Try again with sudo."
  exit!
end

options = {
  pro_account: false
}

OptionParser.new do |opts|
  opts.banner = "Usage: sudo arf [options]"

  opts.on('-t', '--token TOKEN', 'Access token for Travis CI Pro') do |token|
    options[:access_token] = token
  end

  opts.on('-a', '--account ACCOUNT', 'Github organisation or account to search for repos in') do |account|
    options[:travis_account] = account
  end

  opts.on('-p', '--[no]-pro', 'Use a Travis CI Pro account, not a free one') do |pro|
    options[:pro_account] = pro
  end

end.parse!

arf = Arf.new(options)

arf.start!

puts "Starting Arf..."
